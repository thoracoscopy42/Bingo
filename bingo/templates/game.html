{% extends "base.html" %}
{% load static %}
{% block content %}
<audio id="saveSound" src="{% static 'bingo/sfx/yipiee-tbh.mp3' %}" preload="auto"></audio>
<div id="toast" class="toast" role="status" aria-live="polite"></div>


<div class="page">
  <div class="hero hero--wide">
    <div class="panel panel--wide">

      <div class="panel__top">
        <span class="panel__pill">
          Zalogowany jako: {{ request.user.username }}
        </span>
        


        <form method="post" action="{% url 'logout' %}" class="logout-form">
          {% csrf_token %}
          <button type="submit" class="btn btn--danger">Wyloguj</button>
        </form>

      </div>

      <form>
        <table class="grid-table">
          {% for r in rows %}
          <tr>
            {% for c in cols %}
            <td>
              <div class="cell-wrapper">
                <textarea
                  class="grid-cell grid-cell--with-select"
                  data-cell="cell_{{ r }}_{{ c }}"
                  rows="4"
                  placeholder="Wpisz zdanie..."
                ></textarea>

                {% comment %} bierzemy listę userów z backendu {% endcomment %}
                <select
                  class="cell-user cell-user--inside"
                  data-cell="cell_{{ r }}_{{ c }}"
                  data-enhance="dropdown"
                >
                <option value="" selected> </option>
                  {% for u in usernames %}
                    <option value="{{ u }}">{{ u }}</option>
                  {% endfor %}
                </select>
              </div>
            </td>
            {% endfor %}
          </tr>
          {% endfor %}
        </table>

        <div class="actions" style="margin-top: 14px;">
          <button class="btn btn--primary" type="button" id="save-btn">Zapisz</button>
          <a class="btn btn--secondary" href="{% url 'raffle' %}">Losowanie</a>
        </div>

        <p class="fineprint">
          Każdy użytkownik może być przypisany do maksymalnie dwóch pól z wyjątkiem "Event" oraz "Ktokolwiek".
        </p>
      </form>

    </div>
  </div>
</div>

{% comment %} jeśli istnieje już zapisany template to go wrzucamy na stronkę, inaczej blank {% endcomment %}
{{ saved_grid|json_script:"saved-grid" }}
{{ request.user.username|json_script:"current-user" }}

{% endblock %}

{% block scripts %}

  <script defer src="{% static 'bingo/js/game.js' %}"></script>
{% endblock %}

